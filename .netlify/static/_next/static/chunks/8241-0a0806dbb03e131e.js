"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8241],{96801:(e,r,t)=>{t.d(r,{A:()=>n});var o=t(95155);t(12115);var a=t(49428),l=t(60410);let n=e=>{let{status:r}=e,{translate:t}=(0,l.A)();return(0,o.jsx)(a.A,{className:"capitalize",variant:{accepted:"success",rejected:"danger",pending:"warning"}[r],children:t("dashboard.approval.flow.status.".concat(r))})}},81877:(e,r,t)=>{t.d(r,{A:()=>u});var o=t(12115),a=t(69402),l=t(1862),n=t(13596);let u=e=>{var r,t,u;let{businessUnitKey:s,filters:{searchQuery:i,status:p,cursor:c}={}}=e,{data:v,...d}=(0,a.Ay)(s?["/action/business-unit/queryApprovalFlows",s,i,p]:null,()=>n.x.composableCommerce.businessUnit.queryApprovalFlows({businessUnitKey:s,approvalFlowIds:[...i?[i]:[]],approvalFlowStatus:[...p?[p]:[]],cursor:c,sortAttributes:[{createdAt:"desc"}]})),m=!s||d.isLoading,{mutate:y}=(0,l.iX)(),A=(0,o.useCallback)(()=>{y(e=>"object"==typeof e&&(null==e?void 0:e[0].startsWith("/action/business-unit/queryApprovalFlows")),void 0,{revalidate:!0})},[y]),w=(null==v?void 0:v.isError)?[]:null!==(t=null==v?void 0:null===(r=v.data)||void 0===r?void 0:r.items)&&void 0!==t?t:[],h=(null==v?void 0:v.isError)?0:null!==(u=null==v?void 0:v.data.total)&&void 0!==u?u:0,[k,F]=(null==v?void 0:v.isError)?[void 0,void 0]:[null==v?void 0:v.data.previousCursor,null==v?void 0:v.data.nextCursor];return{approvalFlows:w,isLoading:m,totalItems:h,previousCursor:k,nextCursor:F,approveApprovalFlow:(0,o.useCallback)(async e=>{if(!s)return;let r=await n.x.composableCommerce.businessUnit.approveApprovalFlow({approvalFlowId:e},{approvalFlowId:e});return(null==r?void 0:r.isError)||!r.data.approvalFlowId||A(),r.isError?null:r.data},[s,A]),rejectApprovalFlow:(0,o.useCallback)(async(e,r)=>{if(!s)return;let t=await n.x.composableCommerce.businessUnit.rejectApprovalFlow({approvalFlowId:e,reason:null!=r?r:""},{approvalFlowId:e,reason:null!=r?r:""});return(null==t?void 0:t.isError)||!t.data.approvalFlowId||A(),t.isError?null:t.data},[s,A]),mutateAll:A}}},51160:(e,r,t)=>{t.d(r,{M:()=>o});let o=e=>{let{countries:r}=e;return{"totalPrice.centAmount":{type:"text",name:"cart.cart.amount",operators:[{name:"common.is.equal",value:"="},{name:"common.is.more.than",value:">"},{name:"common.is.more.than.or.equal",value:">="},{name:"common.is.less.than",value:"<"},{name:"common.is.less.than.or.equal",value:"<="}],constructPredicateFromRule:e=>"".concat(e.key," ").concat(e.operator," ").concat(100*parseInt(e.value)),constructRuleFromPredicate(e){let[r,t,o]=e.split(" ");return{key:r,operator:t,value:Math.floor(parseInt(o)/100).toString()}}},currency:{type:"enum",name:"common.currency",operators:[{name:"common.is",value:"is"},{name:"common.is.not",value:"is_not"}],values:[{name:"USD",value:"USD"},{name:"EUR",value:"EUR"}],constructPredicateFromRule:e=>"".concat(e.key," ").concat("is"===e.operator?"=":"!=",' "').concat(e.value,'"'),constructRuleFromPredicate(e){let[r,t,o]=e.split(" ");return{key:r,operator:"="===t?"is":"is_not",value:o}}},country:{type:"enum",name:"common.country",operators:[{name:"common.is",value:"is"},{name:"common.is.not",value:"is_not"}],values:r.map(e=>{let{name:r,code:t}=e;return{name:r,value:t}}),constructPredicateFromRule:e=>"".concat(e.key," ").concat("is"===e.operator?"=":"!=",' "').concat(e.value,'"'),constructRuleFromPredicate(e){let[r,t,o]=e.split(" ");return{key:r,operator:"="===t?"is":"is_not",value:o}}}}}},99184:(e,r,t)=>{t.d(r,{K1:()=>u,q_:()=>l});var o=t(70742),a=t(66358);let l=e=>{switch(e){case"accepted":return"Approved";case"rejected":return"Rejected";default:return"Pending"}},n=e=>{switch(e){case"Approved":return"accepted";case"Rejected":return"rejected";default:return"pending"}},u=(e,r)=>{var t,l,u,s,i,p,c,v,d,m,y,A,w,h;return{id:e.approvalFlowId,date:e.order.createdAt?new Date(e.order.createdAt).toISOString():"",status:n(null!==(v=e.approvalFlowStatus)&&void 0!==v?v:"Pending"),businessUnit:{key:e.businessUnitKey},rules:null!==(d=e.approvalRules.map(e=>(0,o.Ah)(e,r)))&&void 0!==d?d:[],order:(0,a.x)(e.order),approvals:(null!==(m=e.approvalFlowApprovals)&&void 0!==m?m:[]).map(e=>{var r,t,o;return{approvedAt:e.approvedAt?new Date(e.approvedAt).toISOString():"",approver:{key:e.approver.accountId,name:"".concat(null!==(r=e.approver.firstName)&&void 0!==r?r:""," ").concat(null!==(t=e.approver.lastName)&&void 0!==t?t:"").trim(),roles:(null!==(o=e.approver.roles)&&void 0!==o?o:[]).map(e=>{let{key:r,name:t}=e;return{key:null!=r?r:"",name:null!=t?t:""}})}}}),rejection:{rejectedAt:(null===(t=e.approvalFlowRejection)||void 0===t?void 0:t.rejectedAt)?new Date(null===(l=e.approvalFlowRejection)||void 0===l?void 0:l.rejectedAt).toISOString():"",reason:null!==(y=null===(u=e.approvalFlowRejection)||void 0===u?void 0:u.reason)&&void 0!==y?y:"",rejecter:{key:null===(s=e.approvalFlowRejection)||void 0===s?void 0:s.rejecter.accountId,name:"".concat(null!==(A=null===(i=e.approvalFlowRejection)||void 0===i?void 0:i.rejecter.firstName)&&void 0!==A?A:""," ").concat(null!==(w=null===(p=e.approvalFlowRejection)||void 0===p?void 0:p.rejecter.lastName)&&void 0!==w?w:"").trim(),roles:(null!==(h=null===(c=e.approvalFlowRejection)||void 0===c?void 0:c.rejecter.roles)&&void 0!==h?h:[]).map(e=>{let{key:r,name:t}=e;return{key:null!=r?r:"",name:null!=t?t:""}})}},eligibleApprovers:e.eligibleApprovers.map(e=>{var r;return{key:null!==(r=e.key)&&void 0!==r?r:"",name:e.name}}),pendingApprovers:e.pendingApprovers.map(e=>{var r;return{key:null!==(r=e.key)&&void 0!==r?r:"",name:e.name}}),currentPendingApproverTiers:e.currentTierPendingApprovers.map(e=>{var r;return{key:null!==(r=e.key)&&void 0!==r?r:"",name:e.name}})}}},70742:(e,r,t)=>{t.d(r,{Ah:()=>s,GO:()=>l});let o=e=>{if(!e)return[];let r=e=>"rule"===e.type?{or:[{key:e.key}]}:{or:e.rules.filter(e=>"rule"===e.type).map(e=>({key:e.key}))};return e.map(e=>e.rules.map(r)).map(e=>({and:e}))},a=(e,r)=>{if(!e)return"";let t=e=>{if("rule"===e.type)return r[e.key].constructPredicateFromRule(e);let o=[];for(let r=0;r<e.rules.length;++r){let a="group"===e.rules[r].type&&e.rules[r].rules.length>1&&e.rules[r].combinator!==e.combinator;a&&o.push("("),o.push(t(e.rules[r])),a&&o.push(")"),r<e.rules.length-1&&o.push(e.combinator.toLowerCase())}return o.join(" ")};return t(e[0])},l=(e,r)=>({name:e.name,description:e.description,requesters:e.requesters,approvalRuleStatus:"active"===e.status?"Active":"Inactive",approvers:{tiers:o(e.approvers)},predicate:a(e.rules,r)}),n=(e,r)=>{let t=e=>{let o=[],a=e.split(" "),l="AND",n=[],u=()=>{let[e,t,a]=[n.pop(),n.pop(),n.pop()];o.push({type:"rule",...r[a].constructRuleFromPredicate("".concat(a," ").concat(t," ").concat(e.replace(/\"/g,"")))})},s=0;for(;s<a.length;){let e=s+1;if("("===a[s]){let r=[],l=0;for(;")"!==a[e]||l>0;)"("===a[e]?++l:")"===a[e]&&--l,r.push(a[e++]);++e,o.push(t(r.join(" ")))}else"and"===a[s]||"or"===a[s]?(l="and"===a[s]?"AND":"OR",u()):n.push(a[s]);s=e}return n.length>0&&u(),{type:"group",combinator:l,rules:o}};return[t(e)]},u=e=>e.tiers.map(e=>e.and).map(e=>({type:"group",combinator:"AND",rules:e.map(e=>{let r=e=>({type:"rule",isPlaceholder:!1,key:e.key,operator:"",value:""});return 1===e.or.length?r(e.or[0]):{type:"group",combinator:"OR",rules:e.or.map(e=>r(e))}})})),s=(e,r)=>{var t,o,a;return{id:null!==(o=null!==(t=e.approvalRuleId)&&void 0!==t?t:e.key)&&void 0!==o?o:"",name:e.name,description:e.description,requesters:e.requesters.map(e=>{var r;let{key:t,name:o}=e;return{key:null!=t?t:"",name:null!==(r=null!=o?o:t)&&void 0!==r?r:""}}),status:(null!==(a=e.approvalRuleStatus)&&void 0!==a?a:"Inactive").toLowerCase(),rules:n(e.predicate,r),approvers:u(e.approvers)}}}}]);
//# sourceMappingURL=8241-0a0806dbb03e131e.js.map