(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8355,8834],{47457:(e,r,s)=>{Promise.resolve().then(s.bind(s,39827)),Promise.resolve().then(s.bind(s,79214)),Promise.resolve().then(s.bind(s,66382)),Promise.resolve().then(s.bind(s,1547)),Promise.resolve().then(s.bind(s,53097)),Promise.resolve().then(s.bind(s,75034)),Promise.resolve().then(s.bind(s,42019)),Promise.resolve().then(s.bind(s,62195)),Promise.resolve().then(s.bind(s,4169)),Promise.resolve().then(s.bind(s,4190)),Promise.resolve().then(s.bind(s,9087)),Promise.resolve().then(s.bind(s,73287)),Promise.resolve().then(s.bind(s,98595)),Promise.resolve().then(s.bind(s,22526)),Promise.resolve().then(s.bind(s,36007)),Promise.resolve().then(s.bind(s,52377)),Promise.resolve().then(s.bind(s,84674)),Promise.resolve().then(s.bind(s,75732)),Promise.resolve().then(s.bind(s,81279)),Promise.resolve().then(s.bind(s,34365)),Promise.resolve().then(s.bind(s,26895)),Promise.resolve().then(s.bind(s,3140)),Promise.resolve().then(s.bind(s,82743)),Promise.resolve().then(s.bind(s,40752)),Promise.resolve().then(s.bind(s,1647)),Promise.resolve().then(s.bind(s,29469)),Promise.resolve().then(s.bind(s,92e3)),Promise.resolve().then(s.bind(s,33698)),Promise.resolve().then(s.bind(s,36607)),Promise.resolve().then(s.bind(s,79254)),Promise.resolve().then(s.bind(s,36211)),Promise.resolve().then(s.bind(s,89930)),Promise.resolve().then(s.bind(s,4090)),Promise.resolve().then(s.bind(s,23697)),Promise.resolve().then(s.bind(s,52737)),Promise.resolve().then(s.bind(s,84718)),Promise.resolve().then(s.bind(s,84828)),Promise.resolve().then(s.bind(s,11835)),Promise.resolve().then(s.bind(s,98036)),Promise.resolve().then(s.bind(s,48429)),Promise.resolve().then(s.bind(s,4288))},49428:(e,r,s)=>{"use strict";s.d(r,{A:()=>o});var l=s(95155);s(12115);var a=s(47234),t=s(40036);let n=e=>{let r=(0,t.F)({intent:{primary:"bg-blue-100 text-blue-600",secondary:"bg-neutral-200 text-primary",warning:"bg-yellow-100 text-yellow-700",success:"bg-green-100 text-green-700",danger:"bg-red-100 text-red-600"}});return{className:(0,a.p)("w-fit rounded-md px-2 py-1 text-12 font-medium",r("intent.".concat(e)))}},o=e=>{let{children:r,variant:s="primary",className:t=""}=e,{className:o}=n(s);return(0,l.jsx)("div",{className:(0,a.p)(o,t),children:r})}},85194:(e,r,s)=>{"use strict";s.d(r,{A:()=>m});var l=s(95155),a=s(12115),t=s(47234),n=s(15033),o=s(33703);let i=e=>{let{disabled:r,readOnly:s,valid:l,error:a}=e;return r?"disabled":s?"readOnly":l?"valid":a?"error":"default"};var d=s(40036);let u=(e,r)=>{let{fitContent:s}=r,l=(0,d.F)({default:"border-gray-300 bg-white text-gray-600 focus:border-neutral-800 active:border-neutral-800",disabled:"cursor-not-allowed border-neutral-200 bg-neutral-200 text-neutral-800 focus:border-neutral-200",readOnly:"cursor-default border-neutral-200 bg-neutral-200 text-gray-600 focus:border-neutral-200 active:border-neutral-800",error:"border-red-500 bg-white text-gray-600 focus:border-red-500 active:border-red-500",valid:"border-green-500 bg-white text-gray-600 focus:border-green-500 active:border-green-500"});return{textAreaClassName:(0,t.p)("flex w-full resize-none rounded-sm border px-3 py-[10px] text-14 focus:outline-none focus:ring-0",l(e),{"overflow-hidden":s})}};var c=s(88989);let m=e=>{let{value:r,defaultValue:s,onChange:d,label:m="",disabled:v=!1,readOnly:p=!1,valid:x=!1,error:h="",required:b=!1,showOptionalLabel:g=!1,requiredStyle:f="asterisk",className:y="",fitContent:j=!1,...N}=e,[w,P]=(0,n.A)(r,s),k=(0,a.useRef)(null),{textAreaClassName:A}=u(i({disabled:v,readOnly:p,valid:x,error:h}),{fitContent:j}),C=(0,a.useCallback)(()=>{j&&k.current&&(k.current.style.height="".concat(k.current.scrollHeight,"px"))},[j]),{ref:F}=(0,o.A)(C),I=(0,a.useCallback)(e=>{C(),P(e.target.value),null==d||d(e)},[d,P,C]);return(0,l.jsxs)("div",{children:[(0,l.jsx)(c.A,{required:b,showOptionalLabel:g,requiredStyle:f,children:m}),(0,l.jsx)("textarea",{ref:e=>{k.current=e,F.current=e},className:(0,t.p)(A,y),value:w,readOnly:p,disabled:v,required:b,onChange:I,...N}),h&&(0,l.jsx)("span",{className:"mt-3 block text-12 font-medium text-red-500",children:h})]})}},72879:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});var l=s(95155),a=s(12115);let t=e=>{let{group:r,label:s,criteria:t,renderRule:n}=e,o=(0,a.useCallback)((e,r)=>{if("rule"===e.type){var s,t,i,d,u,c,m;let a=r.find(r=>r.key===e.key),o=e.key,v=null!==(u=null==a?void 0:a.name)&&void 0!==u?u:o,p=null!==(c=null==a?void 0:null===(t=a.operators)||void 0===t?void 0:null===(s=t.find(r=>r.value===e.operator))||void 0===s?void 0:s.name)&&void 0!==c?c:e.operator,x=null!==(m=null==a?void 0:null===(d=a.values)||void 0===d?void 0:null===(i=d.find(r=>r.value===e.value))||void 0===i?void 0:i.name)&&void 0!==m?m:e.value;return n?n({key:o,name:v,opName:p,valName:x}):(0,l.jsxs)("span",{className:"border border-gray-300 px-2 py-1 text-gray-600",children:[v," ",p," ",x]})}let v=[];for(let s=0;s<e.rules.length;++s){let a="group"===e.rules[s].type&&e.rules[s].rules.length>1&&e.rules[s].combinator!==e.combinator;a&&v.push((0,l.jsx)("span",{className:"text-gray-600",children:"("})),v.push((0,l.jsx)("div",{className:"inline-flex flex-wrap items-center gap-3",children:o(e.rules[s],r)})),a&&v.push((0,l.jsx)("span",{className:"text-gray-600",children:")"})),s<e.rules.length-1&&v.push((0,l.jsx)("span",{children:e.combinator.toLowerCase()}))}return a.Children.toArray(v)},[n]);return(0,l.jsxs)("div",{className:"flex items-start gap-5",children:[s&&(0,l.jsx)("div",{className:"rounded-lg bg-neutral-200 px-6 py-1 font-medium text-gray-700",children:s}),(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:o(r,t)})]})}},17180:(e,r,s)=>{"use strict";s.d(r,{A:()=>n});var l=s(12115),a=s(13596),t=s(69402);let n=()=>{var e,r,s;let n=(0,l.useCallback)(()=>a.x.composableCommerce.businessUnit.getAssociateRoles(),[]),o=(0,t.Ay)("/action/buinsess-unit/getAssociateRoles",n);return{...o,data:(null===(e=o.data)||void 0===e?void 0:e.isError)?[]:null!==(s=null===(r=o.data)||void 0===r?void 0:r.data)&&void 0!==s?s:[]}}},52377:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>O});var l=s(95155),a=s(12115),t=s(11802),n=s(60798),o=s(91938),i=s(60410),d=s(1547),u=s(72879),c=s(47234),m=s(71918),v=s(66382),p=s(85194),x=s(58617),h=s(73761),b=s(96801),g=s(55195),f=s(13578);let y=e=>{var r;let{approvalFlow:s,userRoles:t,viewOnly:n,approversCriteria:y=[],onApprove:j,onReject:N}=e,{translate:w}=(0,i.A)(),[P,k]=(0,a.useState)(!1),[A,C]=(0,a.useState)(!1),[F,I]=(0,a.useState)(""),O=(0,a.useCallback)((e,r)=>"rule"===r.type?e.key===r.key:r.rules.some(r=>O(e,r)),[]),S=(0,a.useMemo)(()=>{if(!s.rules)return[];let e=s.rules.reduce((e,r)=>{var s,l;return Math.max(e,null!==(l=null===(s=r.approvers)||void 0===s?void 0:s.length)&&void 0!==l?l:0)},0),r=[];for(let a=0;a<e;++a)for(let e of(r.push({type:"group",combinator:"AND",rules:[]}),s.rules)){var l;(null===(l=e.approvers)||void 0===l?void 0:l.length)&&a<e.approvers.length&&r.at(-1).rules.push(e.approvers[a])}return r},[s.rules]),_=S.findIndex(e=>{var r;return(null!==(r=s.currentPendingApproverTiers)&&void 0!==r?r:[]).some(r=>O(r,e))})===S.findIndex(e=>t.filter(e=>!s.approvals.some(r=>!!r.approver.roles.find(r=>r.key===e.key))).some(r=>{var l;return O(r,e)&&(null!==(l=s.eligibleApprovers)&&void 0!==l?l:[]).some(e=>e.key===r.key)})),R=t.every(e=>s.approvals.some(r=>!!r.approver.roles.find(r=>r.key===e.key))),z=(0,a.useCallback)(async()=>{k(!0),await (null==N?void 0:N(F)),C(!1),k(!1),x.A.success(w("dashboard.approval.flow.rejected"),{position:"top-right"})},[N,F,w]);return(0,l.jsxs)("div",{children:[n&&(0,l.jsxs)(o.A,{className:"mt-3",children:[(0,l.jsx)("b",{children:w("common.view.only")})," ",w("dashboard.flow.view.only.desc")]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h1",{className:"py-6 text-18 font-extrabold text-gray-800 md:py-7 md:text-20 lg:py-9 lg:text-24",children:w("dashboard.flow.details")}),(0,l.jsx)("div",{className:"hidden items-center justify-normal gap-x-3 md:flex",children:(0,l.jsx)(h.A,{})})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,l.jsxs)("h3",{className:"text-14 text-gray-600",children:[w("dashboard.flow.id"),": ",s.id]}),(0,l.jsxs)("h3",{className:"flex items-center gap-2 text-14 text-gray-600",children:[(0,l.jsxs)("span",{children:[w("common.status"),":"]}),(0,l.jsx)(b.A,{status:s.status})]})]}),(0,l.jsxs)("div",{className:"mt-9 border-t border-neutral-400 pt-10",children:[(0,l.jsx)("h5",{className:"pb-9 text-20 font-bold text-gray-700",children:w("common.approval.flow")}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h6",{className:"text-16 font-semibold text-gray-700",children:w("dashboard.rules.applied")}),(0,l.jsx)("div",{className:"mt-4 flex flex-wrap items-center gap-4 rounded-md border border-gray-300 p-6",children:(null!==(r=s.rules)&&void 0!==r?r:[]).map((e,r,s)=>(0,l.jsxs)("div",{children:[(0,l.jsx)(d.default,{href:"".concat(g.s.approvalRules,"?subPath=edit-approval-rule&id=").concat(e.id),className:"text-16 text-blue-700 underline",children:e.name})," ",r<s.length-1&&(0,l.jsx)("span",{children:","})]},e.id))})]})]}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"text-16 font-semibold text-gray-700",children:w("dashboard.approval.flow.required.approvers")}),(0,l.jsx)("div",{className:"mt-1 text-16 font-normal text-gray-700",dangerouslySetInnerHTML:{__html:w("dashboard.approval.flow.required.approvers.desc",{values:{preview:'<div class="w-fit border border-blue-500 p-1 inline-flex items-center gap-1 rounded-sm text-xs text-blue-500">\n                    <span>'.concat(w("common.name"),'</span>\n                    <span class="w-[12px] h-[12px] border border-gray-500 rounded-full block" />\n                  </div>')}})}})]}),(0,l.jsx)("div",{className:"mt-4 rounded-md border border-gray-300 px-7",children:S.map((e,r,a)=>{var n;return(0,l.jsxs)("div",{className:(0,c.p)("py-6",{"border-b border-neutral-400":r<a.length-1}),children:[(0,l.jsxs)("div",{className:"flex items-start gap-5",children:[(0,l.jsx)("div",{className:"shrink-0 rounded-full bg-neutral-200 px-6 py-1 text-16 font-medium text-gray-700",children:"".concat(w("dashboard.tier")," ").concat(r+1)}),(0,l.jsx)(u.A,{group:e,criteria:y,renderRule:e=>{let{key:r,name:a}=e,n=t.some(e=>e.key===r),o=s.approvals.some(e=>!!e.approver.roles.find(e=>e.key===r));return(0,l.jsxs)("div",{className:(0,c.p)("flex w-fit items-center gap-2 rounded-sm border px-2 py-1",{"border-gray-300":!n,"border-blue-500":n}),children:[(0,l.jsx)("span",{className:(0,c.p)({"text-gray-600":!n,"text-blue-500":n}),children:a}),(0,l.jsx)("span",{className:(0,c.p)("flex size-[20px] items-center justify-center rounded-full border-2 p-[3px]",{"border-green-600":o,"border-gray-300":!o}),children:o&&(0,l.jsx)(m.A,{className:"stroke-[5px] text-green-600"})})]})}})]}),(0,l.jsx)("div",{className:"flex flex-wrap items-center pt-6",children:(null!==(n=s.rules)&&void 0!==n?n:[]).map((e,r,s)=>(0,l.jsxs)("div",{className:"whitespace-pre text-gray-500",children:[e.name," ",r<s.length-1&&(0,l.jsxs)("span",{children:[",","  "]})]},e.id))})]},r)})}),(0,l.jsx)("div",{className:"mt-7 flex gap-3",children:A?(0,l.jsxs)("form",{className:"w-full",onSubmit:async e=>{e.preventDefault(),z()},children:[(0,l.jsx)("h6",{className:"mb-3 text-12 font-medium uppercase text-gray-600",children:w("dashboard.approval.flow.rejection.reason")}),(0,l.jsx)(p.A,{value:F,className:"h-[150px] w-full md:h-[65px]",fitContent:!1,error:F.length>160?w("dashboard.message.too.long",{values:{maxCharacters:"160"}}):"",onChange:e=>I(e.target.value)}),(0,l.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,l.jsx)(v.default,{variant:"secondary",size:"l",onClick:()=>C(!1),children:w("common.cancel")}),(0,l.jsx)(v.default,{type:"submit",size:"l",variant:"primary",loading:P,children:w("common.reject")})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.default,{variant:"secondary",size:"l",className:"leading-[16px]",disabled:n||R||!_||"pending"!==s.status,onClick:()=>{C(!0)},children:w("common.reject")}),(0,l.jsx)(v.default,{variant:"primary",size:"l",className:"py-[12px] leading-[16px]",loading:P,disabled:n||R||!_||"pending"!==s.status,onClick:async()=>{k(!0),await (null==j?void 0:j()),k(!1)},children:w("common.approve")})]})})]}),(0,l.jsx)("div",{className:"mt-10 border-t border-neutral-400",children:(0,l.jsx)(f.A,{order:s.order,showCtaButtons:!1,showOrderStatusBar:!1})})]})};var j=s(37892),N=s(38917),w=s(99184),P=s(66775),k=s(81877),A=s(66493),C=s(36957),F=s(51160),I=s(17180);let O=e=>{var r,s;let{data:a}=e,o=(0,P.A)(),i=null===(r=a.data)||void 0===r?void 0:r.dataSource,{projectSettings:d}=(0,A.A)(),u=(0,F.M)({countries:(null!==(s=null==d?void 0:d.countries)&&void 0!==s?s:[]).map(C.D)}),{selectedBusinessUnit:c}=(0,j.rW)(),{permissions:m}=(0,N.A)(null==c?void 0:c.key),{account:v}=(0,n.A)(),{roles:p}=(0,N.A)(),{data:x}=(0,I.A)(),{approveApprovalFlow:h,rejectApprovalFlow:b}=(0,k.A)({businessUnitKey:null==c?void 0:c.key});return i?(0,l.jsx)(t.A,{userName:null==v?void 0:v.firstName,children:(0,l.jsx)(y,{approvalFlow:(0,w.K1)(i,u),userRoles:p.map(e=>({key:e.key,name:e.name})),viewOnly:!m.UpdateApprovalFlows,approversCriteria:x.map(e=>{let{key:r,name:s}=e;return{key:r,name:null!=s?s:r,type:"text",operators:[],values:[]}}),onApprove:async()=>{let e=await h(i.approvalFlowId);return(null==e?void 0:e.approvalFlowId)&&o.refresh(),!!(null==e?void 0:e.approvalFlowId)},onReject:async e=>{let r=await b(i.approvalFlowId,e);return(null==r?void 0:r.approvalFlowId)&&o.refresh(),!!(null==r?void 0:r.approvalFlowId)}})}):(0,l.jsx)(l.Fragment,{})}}},e=>{var r=r=>e(e.s=r);e.O(0,[3567,5804,2920,8764,8241,1128,8441,1517,7358],()=>r(47457)),_N_E=e.O()}]);
//# sourceMappingURL=page-789fc508f5d1e357.js.map