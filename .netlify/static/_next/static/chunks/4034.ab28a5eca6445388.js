"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4034],{81877:(l,n,i)=>{i.d(n,{A:()=>a});var o=i(12115),e=i(69402),t=i(1862),s=i(13596);let a=l=>{var n,i,a;let{businessUnitKey:r,filters:{searchQuery:d,status:u,cursor:p}={}}=l,{data:v,...c}=(0,e.Ay)(r?["/action/business-unit/queryApprovalFlows",r,d,u]:null,()=>s.x.composableCommerce.businessUnit.queryApprovalFlows({businessUnitKey:r,approvalFlowIds:[...d?[d]:[]],approvalFlowStatus:[...u?[u]:[]],cursor:p,sortAttributes:[{createdAt:"desc"}]})),m=!r||c.isLoading,{mutate:A}=(0,t.iX)(),h=(0,o.useCallback)(()=>{A(l=>"object"==typeof l&&(null==l?void 0:l[0].startsWith("/action/business-unit/queryApprovalFlows")),void 0,{revalidate:!0})},[A]),y=(null==v?void 0:v.isError)?[]:null!==(i=null==v?void 0:null===(n=v.data)||void 0===n?void 0:n.items)&&void 0!==i?i:[],b=(null==v?void 0:v.isError)?0:null!==(a=null==v?void 0:v.data.total)&&void 0!==a?a:0,[w,g]=(null==v?void 0:v.isError)?[void 0,void 0]:[null==v?void 0:v.data.previousCursor,null==v?void 0:v.data.nextCursor];return{approvalFlows:y,isLoading:m,totalItems:b,previousCursor:w,nextCursor:g,approveApprovalFlow:(0,o.useCallback)(async l=>{if(!r)return;let n=await s.x.composableCommerce.businessUnit.approveApprovalFlow({approvalFlowId:l},{approvalFlowId:l});return(null==n?void 0:n.isError)||!n.data.approvalFlowId||h(),n.isError?null:n.data},[r,h]),rejectApprovalFlow:(0,o.useCallback)(async(l,n)=>{if(!r)return;let i=await s.x.composableCommerce.businessUnit.rejectApprovalFlow({approvalFlowId:l,reason:null!=n?n:""},{approvalFlowId:l,reason:null!=n?n:""});return(null==i?void 0:i.isError)||!i.data.approvalFlowId||h(),i.isError?null:i.data},[r,h]),mutateAll:h}}},24034:(l,n,i)=>{i.r(n),i.d(n,{default:()=>C});var o=i(95155),e=i(12115),t=i(66775),s=i(52489),a=i(54843),r=i(56518),d=i(4239),u=i(47240),p=i(47531),v=i(14746),c=i(58617),m=i(60410),A=i(37892),h=i(60798),y=i(13947),b=i(81877),w=i(66493),g=i(36957);let k=()=>{let{translate:l}=(0,m.A)(),{selectedBusinessUnit:n,selectedStore:i}=(0,A.rW)(),{checkout:o}=(0,d.A)(null==n?void 0:n.key,null==i?void 0:i.key);return[{id:"purchase.order",name:"".concat(l("checkout.purchase.order")," (PO)"),description:l("checkout.purchase.order.desc"),image:{src:"",className:""},makePayment:async l=>(await o(l)).orderId}]},C=l=>{var n,i,C,I,f,F,E,U,x,S,M,P;let{data:j}=l,D=(0,t.A)(),{projectSettings:_}=(0,w.A)(),{account:q}=(0,h.A)(),{translate:K}=(0,m.A)(),{addAddress:L}=(0,u.A)(),{selectedBusinessUnit:N,selectedStore:R}=(0,A.rW)(),{mutateAll:W}=(0,b.A)({businessUnitKey:null==N?void 0:N.key}),{cart:O,updateCart:X,setShippingMethod:z,redeemDiscount:B,removeDiscount:G}=(0,d.A)(null==N?void 0:N.key,null==R?void 0:R.key),H=k(),[J,Q]=(0,e.useState)(),[T,V]=(0,e.useState)({});return(0,o.jsx)(s.A,{initialData:{shippingAddress:(null==O?void 0:O.shippingAddress)&&!(0,y.R)(O.shippingAddress)?(0,r.v)(null==O?void 0:O.shippingAddress):void 0,billingAddress:(null==O?void 0:O.billingAddress)&&!(0,y.R)(O.billingAddress)?(0,r.v)(null==O?void 0:O.billingAddress):void 0,shippingMethodId:null==O?void 0:null===(n=O.shippingInfo)||void 0===n?void 0:n.shippingMethodId},paymentMethods:H,discounts:(null!==(i=null==O?void 0:O.discountCodes)&&void 0!==i?i:[]).map(l=>{let{discountId:n,name:i,code:o}=l;return{name:null!=i?i:"",code:null!=o?o:"",onRemove:async()=>!!(await G(null!=n?n:"")).cartId}}),transaction:{subtotal:null!==(C=null==O?void 0:O.transaction.subtotal.centAmount)&&void 0!==C?C:0,discounts:null!==(I=null==O?void 0:O.transaction.discount.centAmount)&&void 0!==I?I:0,shipping:{isEstimated:!(null==O?void 0:O.shippingInfo),amount:null!==(f=null==O?void 0:O.transaction.shipping.centAmount)&&void 0!==f?f:0},taxes:null!==(F=null==O?void 0:O.transaction.tax.centAmount)&&void 0!==F?F:0,total:null!==(E=null==O?void 0:O.transaction.total.centAmount)&&void 0!==E?E:0,currency:null!==(U=null==O?void 0:O.transaction.total.currencyCode)&&void 0!==U?U:"USD"},translations:{review:K("checkout.review.order")},products:(null!==(x=null==O?void 0:O.lineItems)&&void 0!==x?x:[]).map(p.k),addresses:null!==(S=null==N?void 0:N.addresses)&&void 0!==S?S:[],shippingMethods:(null!==(M=null==O?void 0:O.availableShippingMethods)&&void 0!==M?M:[]).map(v.k),countryOptions:(null!==(P=null==_?void 0:_.countries)&&void 0!==P?P:[]).map(g.D).map(l=>{let{name:n,code:i,states:o}=l;return{name:n,value:i,states:o.map(l=>{let{name:n,code:i}=l;return{name:n,value:i}})}}),termsAndConditionsLink:(0,a.s)(j.termsAndConditionsLink),onAddAddress:async l=>null!=N&&!!N.key&&!!(await L({...(0,r.l)(l),businessUnitKey:null==N?void 0:N.key})).businessUnitId,onApplyDiscount:async l=>!!(await B(l)).cartId,onCompleteAddresses:async(l,n)=>!!q&&(await X({email:q.email,shipping:(0,r.l)(l),billing:(0,r.l)(n)})).success,onCompleteShipping:async l=>!!(await z(l)).cartId,onCompletePayment:async(l,n)=>{let i=H.find(n=>n.id===l);return!!i&&(Q(i),V(n),!0)},onSubmitPurchase:async()=>{if(!J)return!1;let l=await J.makePayment(T);return l?(W(),D.push("/thank-you?orderId=".concat(l))):c.A.error(K("common.something.went.wrong"),{position:"top-right"}),!!l}})}}}]);
//# sourceMappingURL=4034.ab28a5eca6445388.js.map